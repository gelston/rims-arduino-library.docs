<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>rims-arduino-library: Rims Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">rims-arduino-library
   &#160;<span id="projectnumber">v1.6.1</span>
   </div>
   <div id="projectbrief">Recirculation infusion mash system library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_rims-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Rims Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Recirculation infusion mash system (RIMS) library for Arduino.  
 <a href="class_rims.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_rims_8h_source.html">Rims.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Rims:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_rims.png" usemap="#Rims_map" alt=""/>
  <map id="Rims_map" name="Rims_map">
<area href="class_rims_ident.html" title="Toolkits for process identification to facilitate PID tunning. " alt="RimsIdent" shape="rect" coords="0,56,65,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac370295657d50fed766ccded3e7da76c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#ac370295657d50fed766ccded3e7da76c">Rims</a> (<a class="el" href="class_u_i_rims.html">UIRims</a> *uiRims, byte analogPinTherm, byte ssrPin, double *currentTemp, double *ssrControl, double *settedTemp)</td></tr>
<tr class="memdesc:ac370295657d50fed766ccded3e7da76c"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR for flow sensor.  <a href="#ac370295657d50fed766ccded3e7da76c">More...</a><br/></td></tr>
<tr class="separator:ac370295657d50fed766ccded3e7da76c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972b17ec148f68ac816ad8a4a29a802d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a972b17ec148f68ac816ad8a4a29a802d">setThermistor</a> (float steinhartCoefs[], float res1, float fineTune=0)</td></tr>
<tr class="memdesc:a972b17ec148f68ac816ad8a4a29a802d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set thermistor parameters.  <a href="#a972b17ec148f68ac816ad8a4a29a802d">More...</a><br/></td></tr>
<tr class="separator:a972b17ec148f68ac816ad8a4a29a802d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5756a8bf5ab82ad100038f62a0c38101"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a5756a8bf5ab82ad100038f62a0c38101">setPinLED</a> (byte pinLED)</td></tr>
<tr class="memdesc:a5756a8bf5ab82ad100038f62a0c38101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pin for heater LED indicator.  <a href="#a5756a8bf5ab82ad100038f62a0c38101">More...</a><br/></td></tr>
<tr class="separator:a5756a8bf5ab82ad100038f62a0c38101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#adbae0aed5b4a4a1f65d0acdb25f2f3cd">setInterruptFlow</a> (byte interruptFlow, float flowFactor, float lowBound=<a class="el" href="_rims_8h.html#ad7811141682133b63e27fa4b248cc8c1">DEFAULTFLOWLOWBOUND</a>, float upBound=<a class="el" href="_rims_8h.html#a0a84a750b7716d5d19303e7256dd2556">DEFAULTFLOWUPBOUND</a>, boolean stopOnCriticalFlow=true)</td></tr>
<tr class="memdesc:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set interrupt function for flow sensor.  <a href="#adbae0aed5b4a4a1f65d0acdb25f2f3cd">More...</a><br/></td></tr>
<tr class="separator:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b4eec1e578f4cf6e3cf1cf9aab4d92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a55b4eec1e578f4cf6e3cf1cf9aab4d92">setHeaterPowerDetect</a> (char pinHeaterVolt)</td></tr>
<tr class="memdesc:a55b4eec1e578f4cf6e3cf1cf9aab4d92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pin to detect if there is voltage applied on heater.  <a href="#a55b4eec1e578f4cf6e3cf1cf9aab4d92">More...</a><br/></td></tr>
<tr class="separator:a55b4eec1e578f4cf6e3cf1cf9aab4d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ca8887b7291dc0e013042e0c17fef31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a6ca8887b7291dc0e013042e0c17fef31">setTuningPID</a> (double Kp, double Ki, double Kd, double tauFilter, int mashWaterQty=-1)</td></tr>
<tr class="memdesc:a6ca8887b7291dc0e013042e0c17fef31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set tuning for PID object.  <a href="#a6ca8887b7291dc0e013042e0c17fef31">More...</a><br/></td></tr>
<tr class="separator:a6ca8887b7291dc0e013042e0c17fef31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8c4f9aabf37a6ed9d74083288a3dd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#aaa8c4f9aabf37a6ed9d74083288a3dd2">setMemCSPin</a> (byte csPin)</td></tr>
<tr class="memdesc:aaa8c4f9aabf37a6ed9d74083288a3dd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pin for flash memory chip select.  <a href="#aaa8c4f9aabf37a6ed9d74083288a3dd2">More...</a><br/></td></tr>
<tr class="separator:aaa8c4f9aabf37a6ed9d74083288a3dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee96dee2f90f42e88b1799affc585d7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ee96dee2f90f42e88b1799affc585d7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>checkMemAccessMode</b> ()</td></tr>
<tr class="separator:a2ee96dee2f90f42e88b1799affc585d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60650cdc19193c465d47b1f3ad72502f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a60650cdc19193c465d47b1f3ad72502f">run</a> ()</td></tr>
<tr class="memdesc:a60650cdc19193c465d47b1f3ad72502f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start and run <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino. ">Rims</a> instance.  <a href="#a60650cdc19193c465d47b1f3ad72502f">More...</a><br/></td></tr>
<tr class="separator:a60650cdc19193c465d47b1f3ad72502f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595c06b4c99ef5c379191a4bffbb1867"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a595c06b4c99ef5c379191a4bffbb1867">getTempPV</a> ()</td></tr>
<tr class="memdesc:a595c06b4c99ef5c379191a4bffbb1867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get temperature from thermistor.  <a href="#a595c06b4c99ef5c379191a4bffbb1867">More...</a><br/></td></tr>
<tr class="separator:a595c06b4c99ef5c379191a4bffbb1867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25026943eb8ac76bfedab303008389e0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a25026943eb8ac76bfedab303008389e0"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a25026943eb8ac76bfedab303008389e0">getFlow</a> ()</td></tr>
<tr class="memdesc:a25026943eb8ac76bfedab303008389e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow from hall-effect flow sensor. <br/></td></tr>
<tr class="separator:a25026943eb8ac76bfedab303008389e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69c666509eb1fc0a22cbed6a20f640b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af69c666509eb1fc0a22cbed6a20f640b"></a>
boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#af69c666509eb1fc0a22cbed6a20f640b">getHeaterVoltage</a> ()</td></tr>
<tr class="memdesc:af69c666509eb1fc0a22cbed6a20f640b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if heater is powered or not. <br/></td></tr>
<tr class="separator:af69c666509eb1fc0a22cbed6a20f640b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678aecfc1cef4220f40ccf1bb65aa753"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a678aecfc1cef4220f40ccf1bb65aa753">stopHeating</a> (boolean state)</td></tr>
<tr class="memdesc:a678aecfc1cef4220f40ccf1bb65aa753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop heater no matter what PID output.  <a href="#a678aecfc1cef4220f40ccf1bb65aa753">More...</a><br/></td></tr>
<tr class="separator:a678aecfc1cef4220f40ccf1bb65aa753"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab5e0dff0c1a6895a261e3e036100ad10"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#ab5e0dff0c1a6895a261e3e036100ad10">_initialize</a> ()</td></tr>
<tr class="memdesc:ab5e0dff0c1a6895a261e3e036100ad10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino. ">Rims</a> instance before starting temperature regulation.  <a href="#ab5e0dff0c1a6895a261e3e036100ad10">More...</a><br/></td></tr>
<tr class="separator:ab5e0dff0c1a6895a261e3e036100ad10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a7997ca5ce25f9ccf8fff58074ffedeac">_iterate</a> ()</td></tr>
<tr class="memdesc:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main method called for temperature regulation at each iteration.  <a href="#a7997ca5ce25f9ccf8fff58074ffedeac">More...</a><br/></td></tr>
<tr class="separator:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd9784f8564d28f177ddfede8edf6af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a5cd9784f8564d28f177ddfede8edf6af">_refreshTimer</a> (boolean verifyTemp=true)</td></tr>
<tr class="memdesc:a5cd9784f8564d28f177ddfede8edf6af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh timer value.  <a href="#a5cd9784f8564d28f177ddfede8edf6af">More...</a><br/></td></tr>
<tr class="separator:a5cd9784f8564d28f177ddfede8edf6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d905079d252ad4f71b3dae4b481cdc5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7d905079d252ad4f71b3dae4b481cdc5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a7d905079d252ad4f71b3dae4b481cdc5">_refreshDisplay</a> ()</td></tr>
<tr class="memdesc:a7d905079d252ad4f71b3dae4b481cdc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh display used by <a class="el" href="class_u_i_rims.html" title="Library to menage LCD and keypad for Rims library. ">UIRims</a> instance. <br/></td></tr>
<tr class="separator:a7d905079d252ad4f71b3dae4b481cdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adfb4f9b99ab42488024b61e5e73c9cb3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#adfb4f9b99ab42488024b61e5e73c9cb3">_refreshSSR</a> ()</td></tr>
<tr class="memdesc:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh solid state relay SSR will be refreshed in function of _controlValPtr value. <br/></td></tr>
<tr class="separator:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab442b1fdf7e9e3f89d99d62043fde87"><td class="memItemLeft" align="right" valign="top">byte&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#aab442b1fdf7e9e3f89d99d62043fde87">_memCountSessions</a> ()</td></tr>
<tr class="memdesc:aab442b1fdf7e9e3f89d99d62043fde87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count how many brew sessions were saved in flash mem.  <a href="#aab442b1fdf7e9e3f89d99d62043fde87">More...</a><br/></td></tr>
<tr class="separator:aab442b1fdf7e9e3f89d99d62043fde87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a507fdf3be8b399af61d28a8d42f2b56c"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a507fdf3be8b399af61d28a8d42f2b56c">_memCountSessionData</a> ()</td></tr>
<tr class="memdesc:a507fdf3be8b399af61d28a8d42f2b56c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count how many data point were taken.  <a href="#a507fdf3be8b399af61d28a8d42f2b56c">More...</a><br/></td></tr>
<tr class="separator:a507fdf3be8b399af61d28a8d42f2b56c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194e641304e729b513ff4bc4cd0e60a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a194e641304e729b513ff4bc4cd0e60a5">_memInit</a> ()</td></tr>
<tr class="memdesc:a194e641304e729b513ff4bc4cd0e60a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize flash memory.  <a href="#a194e641304e729b513ff4bc4cd0e60a5">More...</a><br/></td></tr>
<tr class="separator:a194e641304e729b513ff4bc4cd0e60a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bea25265fe6ad79032bfe16675a997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#ad4bea25265fe6ad79032bfe16675a997">_memAddBrewData</a> (float time, unsigned int cv, float pv, float flow, float timerRemaining)</td></tr>
<tr class="memdesc:ad4bea25265fe6ad79032bfe16675a997"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add data point to the flash memory.  <a href="#ad4bea25265fe6ad79032bfe16675a997">More...</a><br/></td></tr>
<tr class="separator:ad4bea25265fe6ad79032bfe16675a997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb704603feb7f6a742d591c6f587d40"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0bb704603feb7f6a742d591c6f587d40"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a0bb704603feb7f6a742d591c6f587d40">_memDumpBrewData</a> ()</td></tr>
<tr class="memdesc:a0bb704603feb7f6a742d591c6f587d40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump brew session data on USB serial port. <br/></td></tr>
<tr class="separator:a0bb704603feb7f6a742d591c6f587d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0badb9cf3544a5bfe42cbc0ae7ef81df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0badb9cf3544a5bfe42cbc0ae7ef81df"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a0badb9cf3544a5bfe42cbc0ae7ef81df">_memClearAll</a> ()</td></tr>
<tr class="memdesc:a0badb9cf3544a5bfe42cbc0ae7ef81df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all memory via USB serial port. <br/></td></tr>
<tr class="separator:a0badb9cf3544a5bfe42cbc0ae7ef81df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0b133c15c4a39bf11495e3fcde2e581d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b133c15c4a39bf11495e3fcde2e581d"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>RimsIdent</b></td></tr>
<tr class="separator:a0b133c15c4a39bf11495e3fcde2e581d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Recirculation infusion mash system (RIMS) library for Arduino. </p>
<dl class="section author"><dt>Author</dt><dd>Francis Gagnon</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>Only one <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino. ">Rims</a> (or child) instance is allowed with flow sensor because of static method _isrFlowSensor() </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac370295657d50fed766ccded3e7da76c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rims::Rims </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_u_i_rims.html">UIRims</a> *&#160;</td>
          <td class="paramname"><em>uiRims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>analogPinTherm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>ssrPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>currentTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ssrControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>settedTemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ISR for flow sensor. </p>
<p>Constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uiRims</td><td>: UIRims*. Pointer to <a class="el" href="class_u_i_rims.html" title="Library to menage LCD and keypad for Rims library. ">UIRims</a> instance </td></tr>
    <tr><td class="paramname">analogPinTherm</td><td>: byte. Analog pin to thermistor </td></tr>
    <tr><td class="paramname">ssrPin</td><td>: byte. Pin to control heater's solid state relay. </td></tr>
    <tr><td class="paramname">currentTemp</td><td>: double*. Pointer to a double that will be used for current temparature </td></tr>
    <tr><td class="paramname">ssrControl</td><td>: double*. Pointer to a double that will use to control SSR </td></tr>
    <tr><td class="paramname">settedTemp</td><td>: double*. Pointer to a double that will be use to store setted temperature </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab5e0dff0c1a6895a261e3e036100ad10"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_initialize </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino. ">Rims</a> instance before starting temperature regulation. </p>
<p>Initialization procedure :</p>
<ol type="1">
<li>Ask Temperature set point</li>
<li>Ask Timer time</li>
<li>Ask Mash water qty (if setted)</li>
<li>Show pump switching warning</li>
<li>Show heater switching warning </li>
</ol>

<p>Reimplemented in <a class="el" href="class_rims_ident.html#a128946a316b7ad7fb8524ec98db9cb87">RimsIdent</a>.</p>

</div>
</div>
<a class="anchor" id="a7997ca5ce25f9ccf8fff58074ffedeac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_iterate </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main method called for temperature regulation at each iteration. </p>
<p>At each PID calculation (at each SAMPLETIME sec), datas is sent over Serial communication for logging purpose. </p>

<p>Reimplemented in <a class="el" href="class_rims_ident.html#ac70202c7c0012653bfb81cdc19520a63">RimsIdent</a>.</p>

</div>
</div>
<a class="anchor" id="ad4bea25265fe6ad79032bfe16675a997"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_memAddBrewData </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>timerRemaining</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add data point to the flash memory. </p>
<p>Five values is added at _memNextAddr, 18 bytes in total. Temperature setpoint (float : 4 bytes) is saved only once, at the beginning of the brew sessions in <a class="el" href="class_rims.html#a194e641304e729b513ff4bc4cd0e60a5" title="Initialize flash memory. ">_memInit()</a>. For exemple, for the first data (starting at ADDRBREWDATA or 0x001100) of the first brew session, the memory map would be :</p>
<table class="doxtable">
<tr>
<th>Address </th><th>Data </th><th>Size  </th></tr>
<tr>
<td>0x001100 </td><td>sp </td><td>4 bytes </td></tr>
<tr>
<td>0x001104 </td><td>time </td><td>4 bytes </td></tr>
<tr>
<td>0x091108 </td><td>cv </td><td>2 bytes </td></tr>
<tr>
<td>0x09110A </td><td>pv </td><td>4 bytes </td></tr>
<tr>
<td>0x09110E </td><td>flow </td><td>4 bytes </td></tr>
<tr>
<td>0x091102 </td><td>timerRemaining </td><td>4 bytes </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>: float. time in sec of data point </td></tr>
    <tr><td class="paramname">cv</td><td>: unsigned int. SSR control value (mSec at ON state) </td></tr>
    <tr><td class="paramname">pv</td><td>: float. temperature in deg Celcius </td></tr>
    <tr><td class="paramname">flow</td><td>: float. flow in L/min </td></tr>
    <tr><td class="paramname">timerRemaining</td><td>: float. remaining time on timer in seconds. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a507fdf3be8b399af61d28a8d42f2b56c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long Rims::_memCountSessionData </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count how many data point were taken. </p>
<p>When brew data is added in the memory, a sector is filled with "0" to remember how many data were taken. This sector is the first, at the beginning of the memory (ADDRDATACOUNT or 0x000000). If 12 brew data were taken since de beginning (or 12 seconds were ellapsed), the memory map would be like this :</p>
<table class="doxtable">
<tr>
<th>Address </th><th>Data  </th></tr>
<tr>
<td>0x000000 </td><td>b00000000 </td></tr>
<tr>
<td>0x000001 </td><td>b11110000 </td></tr>
<tr>
<td>0x000002 </td><td>b11111111 </td></tr>
<tr>
<td>0x000003 </td><td>b11111111 </td></tr>
<tr>
<td>... </td><td>... </td></tr>
<tr>
<td>0x000FFF </td><td>b11111111 </td></tr>
</table>
<p>I used this method because of a limitation of the flash memory. I could not use normal counting because freshly erased bits can be cleared (set to "0") but cannot be set to "1" without full sector erase. </p>

</div>
</div>
<a class="anchor" id="aab442b1fdf7e9e3f89d99d62043fde87"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">byte Rims::_memCountSessions </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count how many brew sessions were saved in flash mem. </p>
<p>Max is 64 brew sessions, rollback if more. When new brew session is started, the starting address of the datablock is saved in the brew sessions table, starting at ADDRSESSIONTABLE or 0x001000. For exemple, if 2 brew session were done of 2 seconds each (so 4+18+18=40 bytes each), the memory map of the brew sessions table would be :</p>
<table class="doxtable">
<tr>
<th>Address </th><th>Data </th><th>Size  </th></tr>
<tr>
<td>0x001000 </td><td>0x00001100 </td><td>4 bytes </td></tr>
<tr>
<td>0x001004 </td><td>0x00001128 </td><td>4 bytes </td></tr>
<tr>
<td>0x001008 </td><td>0xFFFFFFFF </td><td>4 bytes </td></tr>
<tr>
<td>0x000003 </td><td>0xFFFFFFFF </td><td>4 bytes </td></tr>
<tr>
<td>... </td><td>... </td><td>... </td></tr>
<tr>
<td>0x0010FB </td><td>0xFFFFFFFF </td><td>4 bytes </td></tr>
</table>

</div>
</div>
<a class="anchor" id="a194e641304e729b513ff4bc4cd0e60a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_memInit </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize flash memory. </p>
<p>Verify where to store the new datas and saved temperature setpoint at the beginning of the datablock. </p>

</div>
</div>
<a class="anchor" id="a5cd9784f8564d28f177ddfede8edf6af"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_refreshTimer </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>verifyTemp</em> = <code>true</code>)</td><td></td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refresh timer value. </p>
<p>If error on temperature &gt;= MAXTEMPVAR, timer will not count down. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verifyTemp</td><td>: boolean. If true, error on current temperature should not be greater than MAXTEMPVAR to count down. Else, current temperature is ignored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a595c06b4c99ef5c379191a4bffbb1867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rims::getTempPV </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get temperature from thermistor. </p>
<p>Steinhart-hart equation will be applied here. If voltage is maximal (i.e. ~=5V) it means that the thermistor is not connected and regulation and heating is stopped until reconnection. </p>

</div>
</div>
<a class="anchor" id="a60650cdc19193c465d47b1f3ad72502f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::run </td>
          <td>(</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start and run <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino. ">Rims</a> instance. </p>
<p>Should be called in the loop() function of your sketchbook First time : <a class="el" href="class_rims.html#ab5e0dff0c1a6895a261e3e036100ad10" title="Initialize a Rims instance before starting temperature regulation. ">_initialize()</a> is called Remaining time : <a class="el" href="class_rims.html#a7997ca5ce25f9ccf8fff58074ffedeac" title="Main method called for temperature regulation at each iteration. ">_iterate()</a> is called </p>

</div>
</div>
<a class="anchor" id="a55b4eec1e578f4cf6e3cf1cf9aab4d92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setHeaterPowerDetect </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>pinHeaterVolt</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set pin to detect if there is voltage applied on heater. </p>
<p>If no voltage is detect on the heater, a speaker alarm is trigerred.</p>
<dl class="section warning"><dt>Warning</dt><dd>DO NOT APPLY 120V OR 240V DIRECTLY ON ARDUINO PINS.</dd></dl>
<p>It can be easily and cheaply made with a +5V DC power supply in parallel with the SSR and heater. It is recommended to add a 10Kohm or so resistor in series with the power supply.</p>
<div class="image">
<img src="power_circuit.png" alt="power_circuit.png"/>
<div class="caption">
Voltage detection circuit</div></div>
<p>I use it to detect if my breaker is trigerred or if I shut it off manually with an external switch. If the PID is informed that the heater is shut off, it will run smoother when the heater will be re-powered. This feature is really not mandatory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pinHeaterVolt</td><td>: byte. 5V power supply pin. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adbae0aed5b4a4a1f65d0acdb25f2f3cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setInterruptFlow </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>interruptFlow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>flowFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lowBound</em> = <code><a class="el" href="_rims_8h.html#ad7811141682133b63e27fa4b248cc8c1">DEFAULTFLOWLOWBOUND</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>upBound</em> = <code><a class="el" href="_rims_8h.html#a0a84a750b7716d5d19303e7256dd2556">DEFAULTFLOWUPBOUND</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>stopOnCriticalFlow</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set interrupt function for flow sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">interruptFlow</td><td>: byte. Interrupt pin number connected to the flow sensor. For more info : <a href="http://arduino.cc/en/Reference/attachInterrupt">http://arduino.cc/en/Reference/attachInterrupt</a> </td></tr>
    <tr><td class="paramname">flowFactor</td><td>: float. Factor used to calculate flow from the input frequency, i.e. : <p class="formulaDsp">
\[ freq[Hz] = flowFactor * flow[L/min] \]
</p>
 </td></tr>
    <tr><td class="paramname">lowBound</td><td>: float. Lower bound used for accepted flow rate. </td></tr>
    <tr><td class="paramname">upBound</td><td>: float. Upper bound used for accepted flow rate </td></tr>
    <tr><td class="paramname">stopOnCriticalFlow</td><td>: boolean (default=true). If true and flow is &lt;= CRITICALFLOW on <a class="el" href="class_rims.html#a25026943eb8ac76bfedab303008389e0" title="Get flow from hall-effect flow sensor. ">getFlow()</a> call, heater is turn off. Else flow mesurment doesn't influence heater action. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aaa8c4f9aabf37a6ed9d74083288a3dd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setMemCSPin </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>csPin</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set pin for flash memory chip select. </p>
<p>Code was built on Windbond W25Q80BV SPI flash memory. MOSI, MISO and CLK are fixed pins on all Arduino. For ex, it's 11, 12, 13 for MOSI, MISO and CLK respectivly on Arduino UNO. For more information : <a href="http://arduino.cc/en/Reference/SPI">http://arduino.cc/en/Reference/SPI</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>WINBOND W25Q80BV WORKS IN 3.3V AND MOST ARDUINO WORKS IN 5V. IF IT'S YOUR CASE, DO NOT DIRECTLY CONNECT ARDUINO MOSI, MISO, CLK AND CS ON THE MEMORY PINS.</dd></dl>
<p>If you have to convert 5 V signal to 3.3V signal, here's a simple and cheap circuit that works well.</p>
<div class="image">
<img src="mem_circuit.png" alt="mem_circuit.png"/>
<div class="caption">
Voltage convert flash memory</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">csPin</td><td>: byte. pin used for flash memory chip select. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5756a8bf5ab82ad100038f62a0c38101"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setPinLED </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>pinLED</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set pin for heater LED indicator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pinLED</td><td>: byte </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a972b17ec148f68ac816ad8a4a29a802d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setThermistor </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>steinhartCoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>res1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>fineTuneTemp</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set thermistor parameters. </p>
<div class="image">
<img src="thermistor_circuit.png" alt="thermistor_circuit.png"/>
<div class="caption">
Thermistor voltage divider circuit</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">steinhartCoefs</td><td>: float[4]. Steinhart-hart equation coefficients in order of increasing power, i.e : <p class="formulaDsp">
\[ \frac{1}{T[kelvin]}=C_{0}+C_{1}\ln(R)+C_{2}\ln(R)^2+C_{3}\ln(R)^3 \]
</p>
 for more information : <a href="http://en.wikipedia.org/wiki/Steinhart%E2%80%93Hart_equation">http://en.wikipedia.org/wiki/Steinhart%E2%80%93Hart_equation</a></td></tr>
    <tr><td class="paramname">res1</td><td>: float. In ohm. </td></tr>
    <tr><td class="paramname">fineTuneTemp</td><td>: float. optional (default=0). if you want to add a fine tune factor after the steinhart-hart temperature calculation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6ca8887b7291dc0e013042e0c17fef31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setTuningPID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tauFilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mashWaterQty</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set tuning for PID object. </p>
<p>Algorithm is in parallel form i.e. : </p>
<p class="formulaDsp">
\[ G_{c}(s) = K_{p}+\frac{K_{i}}{s}+\frac{K_{d}s}{Ts+1} \]
</p>
<p> Where \(T=tauFilter[sec]\). It can be set to the same value as a PID output filter.</p>
<p>In practice, a good value of derivative filter is : </p>
<p class="formulaDsp">
\[ T = \frac{K_{d}}{10} \]
</p>
<p>For more information : <a href="http://playground.arduino.cc/Code/PIDLibrary">http://playground.arduino.cc/Code/PIDLibrary</a></p>
<p>For anti-windup, integration static saturation was replaced by <b>integration clamping</b>. Basically, it stop integration at a smarter time than "if limit is reached at the output of the integrator". More precisely, it stop integration <b>if limit is reached at the ouput of the PID</b> <em>AND</em> <b>if the temperature error and and the PID output have the same sign.</b></p>
<div class="image">
<img src="pid.png" alt="pid.png"/>
<div class="caption">
Full PID block diagram</div></div>
 <div class="image">
<img src="clamping.png" alt="clamping.png"/>
<div class="caption">
Integration clamping diagram</div></div>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Kp</td><td>: float. Propotionnal gain </td></tr>
    <tr><td class="paramname">Ki</td><td>: float. Integral gain. </td></tr>
    <tr><td class="paramname">Kd</td><td>: float. Derivative gain. </td></tr>
    <tr><td class="paramname">tauFilter</td><td>: float. Derivative filter time constant in sec. </td></tr>
    <tr><td class="paramname">mashWaterQty</td><td>: int (default=-1). If multiple regulators is needed, set this parameter to mash water volume in liter. This mash water volume will be associated to this PID. Total of 4 regulators is allowed (with different mash water volume). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a678aecfc1cef4220f40ccf1bb65aa753"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::stopHeating </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>state</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop heater no matter what PID output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>: boolean. If true, heater is shut off. Else, heater is turned on. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/francis/Dropbox/Arduino/libraries/rims/<a class="el" href="_rims_8h_source.html">Rims.h</a></li>
<li>/home/francis/Dropbox/Arduino/libraries/rims/<a class="el" href="_rims_8cpp.html">Rims.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat May 31 2014 23:18:08 for rims-arduino-library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
