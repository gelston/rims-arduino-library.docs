<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>rims-arduino-library: Rims Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">rims-arduino-library
   &#160;<span id="projectnumber">v1.5</span>
   </div>
   <div id="projectbrief">Recirculation infusion mash system library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_rims-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Rims Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Recirculation infusion mash system (RIMS) library for Arduino.  
 <a href="class_rims.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_rims_8h_source.html">Rims.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Rims:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_rims.png" usemap="#Rims_map" alt=""/>
  <map id="Rims_map" name="Rims_map">
<area href="class_rims_ident.html" title="Toolkits for process identification to facilitate PID tunning." alt="RimsIdent" shape="rect" coords="0,56,65,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac370295657d50fed766ccded3e7da76c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#ac370295657d50fed766ccded3e7da76c">Rims</a> (<a class="el" href="class_u_i_rims.html">UIRims</a> *uiRims, byte analogPinTherm, byte ssrPin, double *currentTemp, double *ssrControl, double *settedTemp)</td></tr>
<tr class="memdesc:ac370295657d50fed766ccded3e7da76c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ac370295657d50fed766ccded3e7da76c">More...</a><br/></td></tr>
<tr class="separator:ac370295657d50fed766ccded3e7da76c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972b17ec148f68ac816ad8a4a29a802d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a972b17ec148f68ac816ad8a4a29a802d">setThermistor</a> (float steinhartCoefs[], float res1, float fineTune=0)</td></tr>
<tr class="memdesc:a972b17ec148f68ac816ad8a4a29a802d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set thermistor parameters.  <a href="#a972b17ec148f68ac816ad8a4a29a802d">More...</a><br/></td></tr>
<tr class="separator:a972b17ec148f68ac816ad8a4a29a802d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5756a8bf5ab82ad100038f62a0c38101"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a5756a8bf5ab82ad100038f62a0c38101">setPinLED</a> (byte pinLED)</td></tr>
<tr class="memdesc:a5756a8bf5ab82ad100038f62a0c38101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pin for heater LED indicator.  <a href="#a5756a8bf5ab82ad100038f62a0c38101">More...</a><br/></td></tr>
<tr class="separator:a5756a8bf5ab82ad100038f62a0c38101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#adbae0aed5b4a4a1f65d0acdb25f2f3cd">setInterruptFlow</a> (byte interruptFlow, float flowFactor, float lowBound=<a class="el" href="_rims_8h.html#ad7811141682133b63e27fa4b248cc8c1">DEFAULTFLOWLOWBOUND</a>, float upBound=<a class="el" href="_rims_8h.html#a0a84a750b7716d5d19303e7256dd2556">DEFAULTFLOWUPBOUND</a>, boolean stopOnCriticalFlow=true)</td></tr>
<tr class="memdesc:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set interrupt function for flow sensor.  <a href="#adbae0aed5b4a4a1f65d0acdb25f2f3cd">More...</a><br/></td></tr>
<tr class="separator:adbae0aed5b4a4a1f65d0acdb25f2f3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ca8887b7291dc0e013042e0c17fef31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a6ca8887b7291dc0e013042e0c17fef31">setTuningPID</a> (double Kp, double Ki, double Kd, double tauFilter, int mashWaterQty=-1)</td></tr>
<tr class="memdesc:a6ca8887b7291dc0e013042e0c17fef31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set tuning for <a class="el" href="class_p_i_d.html">PID</a> object.  <a href="#a6ca8887b7291dc0e013042e0c17fef31">More...</a><br/></td></tr>
<tr class="separator:a6ca8887b7291dc0e013042e0c17fef31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ebaf110340d939d1e5bccdb1fd5fcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a26ebaf110340d939d1e5bccdb1fd5fcc">setSetPointFilter</a> (double tauFilter, int mashWaterQty=-1)</td></tr>
<tr class="memdesc:a26ebaf110340d939d1e5bccdb1fd5fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Set Point filter.  <a href="#a26ebaf110340d939d1e5bccdb1fd5fcc">More...</a><br/></td></tr>
<tr class="separator:a26ebaf110340d939d1e5bccdb1fd5fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60650cdc19193c465d47b1f3ad72502f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a60650cdc19193c465d47b1f3ad72502f">run</a> ()</td></tr>
<tr class="memdesc:a60650cdc19193c465d47b1f3ad72502f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start and run <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino.">Rims</a> instance.  <a href="#a60650cdc19193c465d47b1f3ad72502f">More...</a><br/></td></tr>
<tr class="separator:a60650cdc19193c465d47b1f3ad72502f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595c06b4c99ef5c379191a4bffbb1867"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a595c06b4c99ef5c379191a4bffbb1867">getTempPV</a> ()</td></tr>
<tr class="memdesc:a595c06b4c99ef5c379191a4bffbb1867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get temperature from thermistor.  <a href="#a595c06b4c99ef5c379191a4bffbb1867">More...</a><br/></td></tr>
<tr class="separator:a595c06b4c99ef5c379191a4bffbb1867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25026943eb8ac76bfedab303008389e0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a25026943eb8ac76bfedab303008389e0"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a25026943eb8ac76bfedab303008389e0">getFlow</a> ()</td></tr>
<tr class="memdesc:a25026943eb8ac76bfedab303008389e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow from hall-effect flow sensor. <br/></td></tr>
<tr class="separator:a25026943eb8ac76bfedab303008389e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678aecfc1cef4220f40ccf1bb65aa753"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a678aecfc1cef4220f40ccf1bb65aa753">stopHeating</a> (boolean state)</td></tr>
<tr class="memdesc:a678aecfc1cef4220f40ccf1bb65aa753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop heater no matter what <a class="el" href="class_p_i_d.html">PID</a> output.  <a href="#a678aecfc1cef4220f40ccf1bb65aa753">More...</a><br/></td></tr>
<tr class="separator:a678aecfc1cef4220f40ccf1bb65aa753"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab5e0dff0c1a6895a261e3e036100ad10"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#ab5e0dff0c1a6895a261e3e036100ad10">_initialize</a> ()</td></tr>
<tr class="memdesc:ab5e0dff0c1a6895a261e3e036100ad10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino.">Rims</a> instance before starting temperature regulation.  <a href="#ab5e0dff0c1a6895a261e3e036100ad10">More...</a><br/></td></tr>
<tr class="separator:ab5e0dff0c1a6895a261e3e036100ad10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a7997ca5ce25f9ccf8fff58074ffedeac">_iterate</a> ()</td></tr>
<tr class="memdesc:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main method called for temperature regulation at each iteration.  <a href="#a7997ca5ce25f9ccf8fff58074ffedeac">More...</a><br/></td></tr>
<tr class="separator:a7997ca5ce25f9ccf8fff58074ffedeac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa509932175d1b91d5c01052d82658f69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#aa509932175d1b91d5c01052d82658f69">_refreshPID</a> ()</td></tr>
<tr class="memdesc:aa509932175d1b91d5c01052d82658f69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh <a class="el" href="class_p_i_d.html">PID</a> value with set point filter and pid filter if setted.  <a href="#aa509932175d1b91d5c01052d82658f69">More...</a><br/></td></tr>
<tr class="separator:aa509932175d1b91d5c01052d82658f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd9784f8564d28f177ddfede8edf6af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a5cd9784f8564d28f177ddfede8edf6af">_refreshTimer</a> (boolean verifyTemp=true)</td></tr>
<tr class="memdesc:a5cd9784f8564d28f177ddfede8edf6af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh timer value.  <a href="#a5cd9784f8564d28f177ddfede8edf6af">More...</a><br/></td></tr>
<tr class="separator:a5cd9784f8564d28f177ddfede8edf6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d905079d252ad4f71b3dae4b481cdc5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7d905079d252ad4f71b3dae4b481cdc5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#a7d905079d252ad4f71b3dae4b481cdc5">_refreshDisplay</a> ()</td></tr>
<tr class="memdesc:a7d905079d252ad4f71b3dae4b481cdc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh display used by <a class="el" href="class_u_i_rims.html" title="Library to menage LCD and keypad for Rims library.">UIRims</a> instance. <br/></td></tr>
<tr class="separator:a7d905079d252ad4f71b3dae4b481cdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adfb4f9b99ab42488024b61e5e73c9cb3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_rims.html#adfb4f9b99ab42488024b61e5e73c9cb3">_refreshSSR</a> ()</td></tr>
<tr class="memdesc:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh solid state relay SSR will be refreshed in function of _controlValPtr value. <br/></td></tr>
<tr class="separator:adfb4f9b99ab42488024b61e5e73c9cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0b133c15c4a39bf11495e3fcde2e581d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b133c15c4a39bf11495e3fcde2e581d"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>RimsIdent</b></td></tr>
<tr class="separator:a0b133c15c4a39bf11495e3fcde2e581d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Recirculation infusion mash system (RIMS) library for Arduino. </p>
<dl class="section author"><dt>Author</dt><dd>Francis Gagnon</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>Only one <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino.">Rims</a> (or child) instance is allowed with flow sensor because of static method _isrFlowSensor() </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac370295657d50fed766ccded3e7da76c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rims::Rims </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_u_i_rims.html">UIRims</a> *&#160;</td>
          <td class="paramname"><em>uiRims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>analogPinTherm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>ssrPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>currentTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ssrControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>settedTemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uiRims</td><td>: UIRims*. Pointer to <a class="el" href="class_u_i_rims.html" title="Library to menage LCD and keypad for Rims library.">UIRims</a> instance </td></tr>
    <tr><td class="paramname">analogPinTherm</td><td>: byte. Analog pin to thermistor </td></tr>
    <tr><td class="paramname">ssrPin</td><td>: byte. Pin to control heater's solid state relay. </td></tr>
    <tr><td class="paramname">currentTemp</td><td>: double*. Pointer to a double that will be used for current temparature </td></tr>
    <tr><td class="paramname">ssrControl</td><td>: double*. Pointer to a double that will use to control SSR </td></tr>
    <tr><td class="paramname">settedTemp</td><td>: double*. Pointer to a double that will be use to store setted temperature </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab5e0dff0c1a6895a261e3e036100ad10"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino.">Rims</a> instance before starting temperature regulation. </p>
<p>Initialization procedure :</p>
<ol type="1">
<li>Ask Temperature set point</li>
<li>Ask Timer time</li>
<li>Ask Mash water qty (if setted)</li>
<li>Show pump switching warning</li>
<li>Show heater switching warning </li>
</ol>

<p>Reimplemented in <a class="el" href="class_rims_ident.html#a128946a316b7ad7fb8524ec98db9cb87">RimsIdent</a>.</p>

</div>
</div>
<a class="anchor" id="a7997ca5ce25f9ccf8fff58074ffedeac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_iterate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main method called for temperature regulation at each iteration. </p>
<p>At each <a class="el" href="class_p_i_d.html">PID</a> calculation (at each SAMPLETIME sec), datas is sent over Serial communication for logging purpose. </p>

<p>Reimplemented in <a class="el" href="class_rims_ident.html#ac70202c7c0012653bfb81cdc19520a63">RimsIdent</a>.</p>

</div>
</div>
<a class="anchor" id="aa509932175d1b91d5c01052d82658f69"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_refreshPID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refresh <a class="el" href="class_p_i_d.html">PID</a> value with set point filter and pid filter if setted. </p>
<p>Must be called at each <a class="el" href="class_p_i_d.html">PID</a> sample time. </p>

</div>
</div>
<a class="anchor" id="a5cd9784f8564d28f177ddfede8edf6af"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::_refreshTimer </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>verifyTemp</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refresh timer value. </p>
<p>If error on temperature &gt;= MAXTEMPVAR, timer will not count down. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verifyTemp</td><td>: boolean. If true, error on current temperature should not be greater than MAXTEMPVAR to count down. Else, current temperature is ignored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a595c06b4c99ef5c379191a4bffbb1867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rims::getTempPV </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get temperature from thermistor. </p>
<p>Steinhart-hart equation will be applied here. If voltage is maximal (i.e. ~=5V) it means that the thermistor is not connected and regulation and heating is stopped until reconnection. </p>

</div>
</div>
<a class="anchor" id="a60650cdc19193c465d47b1f3ad72502f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start and run <a class="el" href="class_rims.html" title="Recirculation infusion mash system (RIMS) library for Arduino.">Rims</a> instance. </p>
<p>Should be called in the loop() function of your sketchbook First time : <a class="el" href="class_rims.html#ab5e0dff0c1a6895a261e3e036100ad10" title="Initialize a Rims instance before starting temperature regulation.">_initialize()</a> is called Remaining time : <a class="el" href="class_rims.html#a7997ca5ce25f9ccf8fff58074ffedeac" title="Main method called for temperature regulation at each iteration.">_iterate()</a> is called </p>

</div>
</div>
<a class="anchor" id="adbae0aed5b4a4a1f65d0acdb25f2f3cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setInterruptFlow </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>interruptFlow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>flowFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lowBound</em> = <code><a class="el" href="_rims_8h.html#ad7811141682133b63e27fa4b248cc8c1">DEFAULTFLOWLOWBOUND</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>upBound</em> = <code><a class="el" href="_rims_8h.html#a0a84a750b7716d5d19303e7256dd2556">DEFAULTFLOWUPBOUND</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>stopOnCriticalFlow</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set interrupt function for flow sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">interruptFlow</td><td>: byte. Interrupt pin number connected to the flow sensor. For more info : <a href="http://arduino.cc/en/Reference/attachInterrupt">http://arduino.cc/en/Reference/attachInterrupt</a> </td></tr>
    <tr><td class="paramname">flowFactor</td><td>: float. Factor used to calculate flow from the input frequency, i.e. : <p class="formulaDsp">
\[ freq[Hz] = flowFactor * flow[L/min] \]
</p>
 </td></tr>
    <tr><td class="paramname">lowBound</td><td>: float. Lower bound used for accepted flow rate. </td></tr>
    <tr><td class="paramname">upBound</td><td>: float. Upper bound used for accepted flow rate </td></tr>
    <tr><td class="paramname">stopOnCriticalFlow</td><td>: boolean (default=true). If true and flow is &lt;= CRITICALFLOW on <a class="el" href="class_rims.html#a25026943eb8ac76bfedab303008389e0" title="Get flow from hall-effect flow sensor.">getFlow()</a> call, heater is turn off. Else flow mesurment doesn't influence heater action. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5756a8bf5ab82ad100038f62a0c38101"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setPinLED </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>pinLED</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set pin for heater LED indicator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pinLED</td><td>: byte </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a26ebaf110340d939d1e5bccdb1fd5fcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setSetPointFilter </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tauFilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mashWaterQty</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Set Point filter. </p>
<p>A set point filter allow you to cancel overshoot (for integretor plant). Normally : </p>
<p class="formulaDsp">
\[ tauFilter=\frac{K_{c}}{K_{i}} \]
</p>
<p>With this value, overshoot will be totally canceled. If you found that that with this time constant, your RIMS is too slow, my advice would be to try from 0.1 to 1 times this value. You will be able to find a good comprimise between overshoot and rapidity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tauFilter</td><td>: float. set point filter time constant in sec. </td></tr>
    <tr><td class="paramname">mashWaterQty</td><td>: int (default=-1). If multiple regulators is needed, set this parameter to mash water volume in liter. This mash water volume will be associated to this set point filter. Rims::setTunningPID must be called with current mashWaterQty value before calling this method. Total of 4 regulators is allowed (with different mash water volume). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a972b17ec148f68ac816ad8a4a29a802d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setThermistor </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>steinhartCoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>res1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>fineTuneTemp</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set thermistor parameters. </p>
<div class="image">
<img src="thermistor_circuit.png" alt="thermistor_circuit.png"/>
<div class="caption">
Thermistor voltage divider circuit</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">steinhartCoefs</td><td>: float[4]. Steinhart-hart equation coefficients in order of increasing power, i.e : <p class="formulaDsp">
\[ \frac{1}{T[kelvin]}=C_{0}+C_{1}\ln(R)+C_{2}\ln(R)^2+C_{3}\ln(R)^3 \]
</p>
 for more information : <a href="http://en.wikipedia.org/wiki/Steinhart%E2%80%93Hart_equation">http://en.wikipedia.org/wiki/Steinhart%E2%80%93Hart_equation</a></td></tr>
    <tr><td class="paramname">res1</td><td>: float. In ohm. </td></tr>
    <tr><td class="paramname">fineTuneTemp</td><td>: float. optional (default=0). if you want to add a fine tune factor after the steinhart-hart temperature calculation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6ca8887b7291dc0e013042e0c17fef31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::setTuningPID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tauFilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mashWaterQty</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set tuning for <a class="el" href="class_p_i_d.html">PID</a> object. </p>
<p>Algorithm is in parallel form i.e. : </p>
<p class="formulaDsp">
\[ G_{c}(s) = [K_{p}+\frac{K_{i}}{s}+K_{d}s]\times\frac{1}{Ts+1} \]
</p>
<p> Where \(T=tauFilter[sec]\) For more information : <a href="http://playground.arduino.cc/Code/PIDLibrary">http://playground.arduino.cc/Code/PIDLibrary</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Kp</td><td>: float. Propotionnal gain </td></tr>
    <tr><td class="paramname">Ki</td><td>: float. Integral gain. </td></tr>
    <tr><td class="paramname">Kd</td><td>: float. Derivative gain. </td></tr>
    <tr><td class="paramname">tauFilter</td><td>: float. <a class="el" href="class_p_i_d.html">PID</a> output filter time constant in sec. </td></tr>
    <tr><td class="paramname">mashWaterQty</td><td>: int (default=-1). If multiple regulators is needed, set this parameter to mash water volume in liter. This mash water volume will be associated to this <a class="el" href="class_p_i_d.html">PID</a>. Total of 4 regulators is allowed (with different mash water volume). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a678aecfc1cef4220f40ccf1bb65aa753"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rims::stopHeating </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop heater no matter what <a class="el" href="class_p_i_d.html">PID</a> output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>: boolean. If true, heater is shut off. Else, heater is turned on. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/francis/Dropbox/Arduino/libraries/rims/<a class="el" href="_rims_8h_source.html">Rims.h</a></li>
<li>/home/francis/Dropbox/Arduino/libraries/rims/<a class="el" href="_rims_8cpp.html">Rims.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 10 2013 11:39:11 for rims-arduino-library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
